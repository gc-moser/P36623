% code

\newcommand{\cmtstyle}{\itshape\color{black!70!white}}
\newcommand{\keystyle}{\color{blue}}
\newcommand{\ctrlstyle}{\color{brown!90!black}}
\newcommand{\emphstyle}{\rmfamily\emph}
\newcommand{\constrstyle}{\color{green!30!black}}
\makeatletter
\newcommand*\haskellidstyle{%
        \expandafter\id@style\the\lst@token\relax
}
\def\id@style#1#2\relax{%
        \ifcat#1\relax\else
                \ifnum`#1=\uccode`#1%
                        \constrstyle
                \fi
        \fi
}
\makeatother

\lstdefinestyle{common}{
  basicstyle=\small\ttfamily\color{green!30!black},
  commentstyle=\cmtstyle,
  keywordstyle=\keystyle,
  emphstyle=\emphstyle, 
  showspaces=false,
  showstringspaces=false,
  flexiblecolumns=false,
  basewidth={0.5em,0.45em},
  tabsize=2,
  captionpos=b,
  mathescape=false,
  xleftmargin=6pt,
  xrightmargin=6pt,
  framexleftmargin=6pt,
  framexrightmargin=6pt,
  abovecaptionskip=\smallskipamount,%\bigskipamount,
  numbers=none, 
}

\lstdefinestyle{framed}{
  frame=b,
}

\lstdefinestyle{haskell}{%
  style=common,
  language=Haskell,
  identifierstyle=\haskellidstyle,
  keywords={data,class,type,where,=,case,of},
  literate= {/}{{$/$}}1 {*}{{$*$}}1 {=}{{{\ctrlstyle{$=$}}}}1
            {>}{{$>$}}1 {<}{{$<$}}1 {\\}{{$\lambda$}}1
            {>>>}{{$\ggg$}}3
            {<|>}{{${<}{|}{>}$}}4
            {<||>}{{${<}{|}{|}{>}$}}4
            {\\\\}{{\char`\\\char`\\}}1
            {::}{{{\ctrlstyle::}}}2
            {->}{{$\ctrlstyle\rightarrow$}}2 {>=}{{$\geq$}}2 {<-}{{{\ctrlstyle$\leftarrow$}}}2
            {<=}{{$\leq$}}2 {=>}{{$\ctrlstyle\Rightarrow$}}2 
            {\ .}{{{\ctrlstyle$\circ$}}}2 {\ .\ }{{{\ctrlstyle$\circ$}}}2
            {|}{{{{\ctrlstyle{$\mid$}}}}}1
            {)}{{{{\ctrlstyle{)}}}}}1
            {(}{{{{\ctrlstyle{(}}}}}1
            {\}}{{{{\ctrlstyle{\}}}}}}1
            {\{}{{{{\ctrlstyle{\{}}}}}1
            {<$>}{{{{\ctrlstyle{<\$>}}}}}3
            {[}{{{\constrstyle{[}}}}1
            {]}{{{\constrstyle{]}}}}1
            {`}{{{\ctrlstyle{`}}}}1
            {Va}{{$\alpha$}}1
            {Vb}{{$\beta$}}1
            {Vc}{{$\gamma$}}1
}

\def\haskell{\lstinline[style=haskell]}
\newcommand*{\module}[1]{{\lstinline[style=common]|#1|}}

\lstdefinestyle{ocaml}{
  language=[Objective]Caml,
  keywords={type,let,in,rec,=,;;,fun,->,match,with},
  morecomment=[s][\cmtstyle]{(*}{*)},
  style=common,
  literate= {/}{{$/$}}1 {*}{{$*$}}1 {=}{{{\ctrlstyle{$=$}}}}1
            {>}{{$>$}}1 {<}{{$<$}}1 {\\}{{$\lambda$}}1
            {:}{{{\ctrlstyle:}}}1
            {::}{{{\constrstyle::}}}2
            {->}{{$\ctrlstyle\rightarrow$}}2 {>=}{{$\geq$}}2 {<-}{{{\ctrlstyle$\leftarrow$}}}2
            {<=}{{$\leq$}}2 {=>}{{$\ctrlstyle\Rightarrow$}}2 
            {\ .}{{{\ctrlstyle$\circ$}}}2 {\ .\ }{{{\ctrlstyle$\circ$}}}2
            {|}{{{{\ctrlstyle{$\mid$}}}}}1
            {)}{{{{\ctrlstyle{)}}}}}1
            {(}{{{{\ctrlstyle{(}}}}}1
            {[}{{{\constrstyle{[}}}}1
            {]}{{{\constrstyle{]}}}}1
            {Va}{{$\alpha$}}1
            {Vb}{{$\beta$}}1
            {Vc}{{$\gamma$}}1
}

\lstdefinestyle{imp}{
  style=common,
  language=C,
}

\lstdefinestyle{repl}{
  style=common,
  basicstyle=\scriptsize\ttfamily,
}

\lstdefinestyle{java}{
  style=common,
  language=Java,
  basicstyle=\footnotesize,
}

\def\java{\lstinline[style=java]}

\lstdefinestyle{llvm}{
  style=common,
  language=LLVM,
  basicstyle=\footnotesize,
}

\lstdefinelanguage{splay}{%
  basicstyle=\color{darkviolet}\ttfamily,
  extendedchars=true,
  alsoletter={*,'},
  % keywordstyle=[1]\color{keyword}\small,
  % keywordstyle=[2]\color{constructor}\small,
  keywordstyle=[1]\color{constructor},
  keywordstyle=[2]\color{keyword},
  otherkeywords={(,),\,},
  keywords=[1]{leaf,node,true,false,(,),},
  keywords=[2]{if,then,else,match,with,let,in},
  sensitive=true,
  morecomment=[l]{!}, % l is for line comment
  commentstyle=\color{darkgray}, % style of comments
  numberstyle=\tiny%\color{darkgray}
  %xleftmargin=0pt,
  %xrightmargin=0pt,
  %framexleftmargin=0pt,
  %literate={â†’}{{\to}}1
}


